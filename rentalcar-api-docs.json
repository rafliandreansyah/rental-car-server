{
  "openapi": "3.0.3",
  "info": {
    "title": "Rental Car Server",
    "description": "Api documentation rental car server",
    "version": "1.0.0",
    "contact": {
      "name": "Rafli Andreansyah",
      "email": "rafliandreansyah957@gmail.com",
      "url": "https://www.linkedin.com/in/rafli-andreansyah-86299217a"
    }
  },
  "servers": [
    {
      "url": "https://{env}:{port}/api/{version}",
      "description": "Server developer rental car",
      "variables": {
        "env": {
          "description": "Environtment url",
          "default": "localhost",
          "enum": [
            "localhost"
          ]
        },
        "port": {
          "description": "port server rental car",
          "default": "8080",
          "enum": [
            "8080",
            "8081"
          ]
        },
        "version": {
          "description": "api version",
          "default": "v1",
          "enum": [
            "v1"
          ]
        }
      }
    }
  ],
  "paths": {
    "/auth/authenticate": {
      "post": {
        "description": "end point for a authentication user",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "email": {
                    "type": "string",
                    "required": true
                  },
                  "password": {
                    "type": "string",
                    "required": true
                  }
                }
              },
              "examples": {
                "login": {
                  "summary": "request login",
                  "value": {
                    "email": "test@gmail.com",
                    "password": "secure"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "success login",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataObject"
                },
                "examples": {
                  "success": {
                    "value": {
                      "status": 200,
                      "error": null,
                      "data": {
                        "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/UserNotFoundError"
          },
          "401": {
            "description": "invalid email or password",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataObject"
                },
                "examples": {
                  "not found": {
                    "value": {
                      "status": 401,
                      "error": "Invalid email or password",
                      "data": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auth/reset": {
      "post": {
        "description": "end point for reset password",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "email": {
                    "type": "string",
                    "required": true
                  }
                }
              },
              "examples": {
                "reset": {
                  "value": {
                    "email": "reset@gmail.com"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "response success send reset password to email",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataObject"
                },
                "examples": {
                  "success": {
                    "value": {
                      "status": 200,
                      "error": null,
                      "data": {
                        "message": "Send link reset password success. Please check your email message to reset password"
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/UserNotFoundError"
          }
        }
      }
    },
    "/auth/register": {
      "post": {
        "description": "Registration new user",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GeneralResponseWithDataObject"
              },
              "examples": {
                "register": {
                  "value": {
                    "email": "email@mail.com",
                    "password": "secretpassword",
                    "name": "alexandre",
                    "phone": "+6281232720821"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "response register success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataObject"
                },
                "examples": {
                  "success": {
                    "description": "register success example",
                    "value": {
                      "status": 200,
                      "error": null,
                      "data": "success register"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "error validation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataObject"
                },
                "examples": {
                  "bad request": {
                    "value": {
                      "status": 400,
                      "error": "format email not valid",
                      "data": null
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "error when user already registered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataObject"
                },
                "examples": {
                  "conflict": {
                    "value": {
                      "status": 409,
                      "error": "user with this email already registered",
                      "data": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/users": {
      "get": {
        "description": "get list of users",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "name": "role",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "is_active",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "success response get list users",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataArrayObject"
                },
                "examples": {
                  "success": {
                    "value": {
                      "status": 200,
                      "error": null,
                      "data": [
                        {
                          "id": "0092HSH-0092HSH",
                          "image_url": "https://user-profilerafli.com",
                          "name": "rafli a",
                          "phone": "+62039477755",
                          "is_active": "true"
                        }
                      ]
                    }
                  }
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/AccessForbiddenError"
          }
        }
      },
      "post": {
        "description": "create data users",
        "tags": ["Users"],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "required": true,
                    "type": "string"
                  },
                  "password": {
                    "required": true,
                    "type": "string"
                  },
                  "name": {
                    "required": true,
                    "type": "string"
                  },
                  "phone": {
                    "required": true,
                    "type": "string"
                  },
                  "role": {
                    "required": true,
                    "type": "string"
                  },
                  "dob": {
                    "description": "timestamp",
                    "required": false,
                    "type": "number"
                  },
                  "image": {
                    "required": false,
                    "type": "array",
                    "items": {
                      "format": "binary",
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "success create user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataString"
                },
                "examples": {
                  "success": {
                    "value": {
                      "status": 201,
                      "error": null,
                      "data": "success create user"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/AccessForbiddenError"
          },
          "409": {
            "description": "error when user already registered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataObject"
                },
                "examples": {
                  "conflict": {
                    "value": {
                      "status": 409,
                      "error": "user with this email already registered",
                      "data": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/users/{id}": {
      "get": {
        "description": "get detail user by id",
        "tags": ["Users"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "response success get detail users",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataObject"
                },
                "examples": {
                  "success": {
                    "value": {
                      "status": 200,
                      "error": null,
                      "data": {
                        "id": "8DJS-KWME-DMWA-MDMM",
                        "name": "suprianto alexandre",
                        "image_url": "https://media.istockphoto.com/id/1386479313/photo/happy-millennial-afro-american-business-woman-posing-isolated-on-white.webp?b=1&s=170667a&w=0&k=20&c=ahypUC_KTc95VOsBkzLFZiCQ0VJwewfrSV43BOrLETM=",
                        "dob": "1996-12-20",
                        "phone": "+6289373622",
                        "is_active": "true",
                        "role": "USER",
                        "date_created": "2023-10-30"
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/UserNotFoundError"
          },
          "403": {
            "$ref": "#/components/responses/AccessForbiddenError"
          }
        }
      },
      "delete": {
        "description": "delete user by id",
        "tags": ["Users"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "success delete user data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneralResponseWithDataString"
                },
                "examples": {
                  "success": {
                    "value": {
                      "status": "200",
                      "error": null,
                      "data": "success delete data user"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/UserNotFoundError"
          },
          "403": {
            "$ref": "#/components/responses/AccessForbiddenError"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "GeneralResponseWithDataObject": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer"
          },
          "error": {
            "type": "string"
          },
          "data": {
            "type": "object"
          }
        }
      },
      "GeneralResponseWithDataArrayObject": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer"
          },
          "error": {
            "type": "string"
          },
          "data": {
            "type": "array",
            "items": {
              "type": "object"
            }
          }
        }
      },
      "GeneralResponseWithDataString": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer"
          },
          "error": {
            "type": "string"
          },
          "data": {
            "type": "string"
          }
        }
      }
    },
    "responses": {
      "UserNotFoundError": {
        "description": "Response error for user not found",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/GeneralResponseWithDataObject"
            },
            "examples": {
              "error": {
                "value": {
                  "status": 404,
                  "error": "user doesn't exist",
                  "data": null
                }
              }
            }
          }
        }
      },
      "AccessForbiddenError": {
        "description": "response error forbidden access",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/GeneralResponseWithDataArrayObject"
            },
            "examples": {
              "forbidden": {
                "value": {
                  "status": 403,
                  "error": "access forbidden to access this data",
                  "data": null
                }
              }
            }
          }
        }
      }
    }
  }
}
